<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Canal & River Trust Jukebox</title>
<style>
/* --- Fixed the hex code for --water-hero --- */
:root{ --water-hero:#1e29f5; --deep-water:#00416e; --sky:#33d8ff; --white:#ffffff; --leaf:#0a4f6b; --poppy:#e64f00; --bg:var(--deep-water); --panel:var(--water-hero); --chrome:var(--sky); --accent:var(--poppy); --text:var(--white); }
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;display:flex;justify-content:center;align-items:center;min-height:100vh}
.jukebox{position:relative;width:1024px;height:700px;background:linear-gradient(180deg,var(--panel),var(--deep-water));border-radius:24px;overflow:hidden;display:grid;grid-template-rows:auto 1fr;box-shadow:0 20px 60px rgba(0,0,0,.6), inset 0 0 0 8px var(--sky)}
.crt-logo {
  position: absolute;
  top: 12px;
  right: 14px;
  height: 20px;
  width: auto;
  z-index: 2;
}
.header{background:var(--deep-water);border-bottom:1px solid var(--sky);padding:10px 14px;font-weight:700}
.content{display:flex;gap:20px;padding:18px;height:100%;min-height:0}
.left{flex:1;display:grid;grid-template-rows:auto auto auto 1fr;gap:10px;min-width:0}
.right{width:380px;display:grid;grid-template-rows:1fr 1fr;gap:12px;min-height:0}
.panel{background:linear-gradient(180deg,var(--water-hero),var(--deep-water));border:1px solid var(--sky);border-radius:14px;overflow:hidden;display:flex;flex-direction:column;min-height:0}
.panel h3{margin:0;background:var(--deep-water);border-bottom:1px solid var(--sky);padding:10px;font-weight:700}
.scrollable{flex:1;overflow:auto;min-height:0}
.row{display:flex;align-items:center;gap:10px;padding:8px;border-bottom:1px solid rgba(255,255,255,.12)}
.row:hover{background:var(--leaf);cursor:pointer}
.cover{width:100%;max-width:520px;aspect-ratio:1/1;border-radius:14px;object-fit:cover;box-shadow:0 12px 28px rgba(0,0,0,.45)}
.default-cover{display:flex;align-items:center;justify-content:center;flex-direction:column;width:100%;max-width:520px;aspect-ratio:1/1;border-radius:14px;background:var(--deep-water);color:var(--sky);font-size:1.1rem;text-align:center;padding:20px;box-shadow:0 12px 28px rgba(0,0,0,.45)}
.trash{margin-left:auto;cursor:pointer;border:0;background:transparent;color:#ffd2c2;font-weight:800}
/* Autoplay gate */
.gate{position:absolute;inset:0;display:none;place-items:center;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);z-index:5}
.gate .btn{background:linear-gradient(180deg,var(--sky),var(--water-hero));color:#fff;border:1px solid var(--chrome);border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.25)}
/* Ticker + controls */
#ticker{white-space:nowrap;overflow:hidden;border-top:1px solid var(--sky);border-bottom:1px solid var(--sky);min-height:34px;display:flex;align-items:center;padding:4px 10px}
#ticker span{display:inline-block;padding-left:100%;animation:scroll-left 14s linear infinite}
@keyframes scroll-left{0%{transform:translateX(0)}100%{transform:translateX(-100%)} }
.controls{display:flex;justify-content:center;align-items:center;gap:20px;}
.controls .btn{background:linear-gradient(180deg,var(--sky),var(--water-hero));color:#fff;border:1px solid var(--chrome);border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.25)}
.controls .btn[disabled]{opacity:.5;cursor:not-allowed}

/* --- Responsive styles for mobile --- */
@media (max-width: 800px) {
  body {
    /* Remove desktop centering */
    display: block;
  }

  .jukebox {
    width: 100%;
    height: auto; /* Let content define height */
    min-height: 100vh; /* Fill at least the whole screen */
    border-radius: 0;
    box-shadow: none;
    /* Change main layout to stack header and content */
    display: flex;
    flex-direction: column;
  }
  
  .header {
    /* Make header sticky for better mobile UX */
    position: sticky;
    top: 0;
    z-index: 10;
  }

  .content {
    flex-direction: column; /* Stack left and right sections */
    height: auto; /* Allow content to grow */
    flex-grow: 1; /* Take up remaining space */
  }

  .left {
      /* Stack cover, ticker, controls. Remove 1fr spacer row */
    grid-template-rows: auto auto auto;
    gap: 20px; /* Add some vertical space */
  }
  
  .left > div:last-child {
      /* This was the '1fr' spacer, hide it on mobile */
      display: none;
  }

  .cover, .default-cover {
      /* Adjust cover art size for smaller screens */
      width: 100%;
      max-width: 400px; /* Don't let it get *too* big */
  }

  .right {
    width: 100%; /* Take full width */
    display: flex; /* Stack the two panels */
    flex-direction: column;
    height: auto; /* Reset height */
    min-height: 0; /* Reset */
  }

  .panel {
    /* Give panels a fixed height so internal scrollbars work */
    height: 300px;
    min-height: 200px; /* Ensure it's at least this tall */
  }
}

</style>
</head>
<body>

<div class="jukebox" role="application" aria-label="CRT Jukebox">
  <img src="https://dl.dropboxusercontent.com/scl/fi/6hh4aygdngjrbcu1vnbr5/white-logo-new.png?rlkey=3fbkidr2jqhpjp52tjmp66q7e&st=0ne2f17a&dl=1" alt="Canal & River Trust Logo" class="crt-logo">
  <div class="gate" id="gate"><button class="btn" id="startAudio">Tap to start audio</button></div>
  <div class="header">Podcast player</div>
  <div class="content">
    <section class="left">
      <div style="display:grid;place-items:center;">
        <div id="coverContainer" aria-live="polite"></div>
      </div>
      <div id="ticker"><span>—</span></div>
      <div class="controls">
        <button class="btn" id="playPauseBtn" type="button" disabled>▶</button>
        <button class="btn" id="skipBtn" type="button" disabled>Skip to next song</button>
      </div>
      <div></div>
    </section>
    <section class="right">
      <div class="panel">
        <h3>Available Tracks</h3>
        <div id="library" class="scrollable" aria-label="Available tracks"></div>
      </div>
      <div class="panel">
        <h3>Play Queue</h3>
        <div id="queue" class="scrollable" aria-label="Play queue"></div>
      </div>
    </section>
  </div>
</div>
<script>
/******** Utils ********/
function directDropbox(url){
  try{const u=new URL(url);if(u.hostname.includes('dropbox.com')){u.searchParams.set('dl','1');return u.toString().replace('www.dropbox.com','dl.dropboxusercontent.com');}}catch(e){}
  return url;
}
// tests (leave in)
console.assert(directDropbox('https://www.dropbox.com/s/abc/file.mp3?dl=0').includes('dl.dropboxusercontent.com') && /dl=1/.test(directDropbox('https://www.dropbox.com/s/abc/file.mp3?dl=0')),'dbx rewrite');
console.assert(directDropbox('https://example.com/x.mp3')==='https://example.com/x.mp3','non-DBX unchanged');

/******** Tracks ********/
const TRACKS=[
  {title:'Feel Alive by the Waterside',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/2i5ubsl7fh8zrfebek7sr/Track-1-Feel-Alive-by-the-Waterside.mp3?rlkey=tsv3m877ye5pbckq61ul52ej8&st=56axatba&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/ouw79px873v5dsafjtoff/Photo-10-08-2025-22-11-54.jpg?rlkey=e8q7zkziowjd1auxvn36vv9e7&st=ypbp2irv&dl=0')},
  {title:'Let\u2019s Get Outdoors',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/kyk7cqizuaj8r3nn0tomm/Track-2-Let-s-Get-Outdoors.mp3?rlkey=m1go1x1nt5xjauy4suftdih8y&st=vtp5w8y1&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/kxc6j2httffjyrelid6r2/Photo-10-08-2025-22-12-43.jpg?rlkey=qkqnjywng343ft0giszycg8h4&st=qs4sx5gt&dl=0')},
  {title:'Stay Clean, Stay Green',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/xtkq63vs3len0jz3qo5yg/Track-3-Stay-Clean-Stay-Green.mp3?rlkey=pabetjm16ghkvbx7jn2fbo9rb&st=5enyx6rb&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/o6qa6t666e2byuupux1zg/Photo-10-08-2025-22-12-36.jpg?rlkey=1jd4attqob9dwhm1l82mfasbp&st=r4kxvu21&dl=0')},
  /* --- Fixed broken URL (was https.dropbox...) --- */
  {title:'Stay Kind, Slow Down',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/bo34azv4velxv41rxeh2x/Track-4-Stay-Kind-Slow-Down.mp3?rlkey=s53dhmoah1m5urf2s48hkg15x&st=asb3ldsr&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/ow9b6gm5iyoggg4kav7rg/Photo-10-08-2025-22-12-29.jpg?rlkey=aja3de3vgf6jyzosb2irjzrho&st=ldcfle2r&dl=0')},
  {title:'Hold Hands, Take Two Steps Back (Dance Version)',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/8zjotwwqu293zs6imlfu2/Track-5-Hold-Hands-Take-Two-Steps-Back-Dance-Version.mp3?rlkey=3dudmtvm2kacnfdizd68y2mh3&st=zpr9f0cy&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/sk3kj3icnlllm4yzuu38a/Photo-10-08-2025-22-12-21.jpg?rlkey=l7khv2tqp4kauqe2bnb4mwtrg&st=52y71uq7&dl=0')},
  {title:'Hold Hands, Take Two Steps Back (Chill Version)',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/1likb9o7uxp4juwuxsyk8/Track-6-Hold-Hands-Take-Two-Steps-Back-Chill-Version.mp3?rlkey=4fmcorjl0qp6af4dhrd6oyt70&st=766n03zo&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/sk3kj3icnlllm4yzuu38a/Photo-10-08-2025-22-12-21.jpg?rlkey=l7khv2tqp4kauqe2bnb4mwtrg&st=52y71uq7&dl=0')},
  /* --- Removed 'D-8 ' text that was causing the error --- */
  {title:'Greenflag Vibe',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/jcz55dta8pdln17nnj49t/Track-7-Greenflag-Vibe.mp3?rlkey=qs1gzizz92uvk39wwdg9w7nhs&st=b8ds4ic1&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/hell3ykhxtavqsnzcufjr/Photo-10-08-2025-22-12-05.jpg?rlkey=39wqql61slnwlv4069m70tt9x&st=53j2zus9&dl=0')},
  {title:'Canals of Time',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/km2ozuq2240dqprd1suue/Track-8-Canals-of-Time.mp3?rlkey=yu1fhyqnpjiwht0l2dir6ah69&st=crs2xeyu&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/5ae6v1wa72aztt5lmphil/Photo-10-08-2025-22-12-55.jpg?rlkey=xy030q3xovwb2i89ta2dmblum&st=jq7ho85t&dl=0')},
  {title:'Cathedral of the Waterways',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/2ws7p0k5cklphb532f3ww/Track-9-Cathedral-of-the-Waterways.mp3?rlkey=re6clson70tvnp8akupzpal7w&st=cn5tqkaw&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/ozbaqv219y2bzr2ko1z7b/Photo-10-08-2025-22-13-15.jpg?rlkey=desx3udzb79jmdyb9lii6p06h&st=2ljozt4c&dl=0')},
  {title:'Beneath the Pennine Hills',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/gr6iecq4ljjbcjfjk8bg1/Track-11-Beneath-the-Pennine-Hills.mp3?rlkey=jcqujf86wx7wss3tmh0vrop2h&st=aiktj08t&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/7bphjfdc8vn45tb52dbus/Photo-10-08-2025-22-13-40.jpg?rlkey=f5qyglbirgomjgkkjzzyvh67k&st=1vusobza&dl=0')},
  {title:'Pontcysyllte Sky',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/qile0n8m8ouj7g6ryp3y7/Track-12-Pontcysyllte-Sky.mp3?rlkey=7jqr9inaasf0wmtti0tp1hdh5&st=pak544mx&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/6x26j8ovlmlt7611gospm/Photo-10-08-2025-22-14-02.jpg?rlkey=6slaebwiu3rfi5e6a5a5neamz&st=6v6qsqni&dl=0')},
  {title:'More Canal\u2019s Than Venice',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/8s4dpwcz4123lfrssr9ub/Track-14-More-Canals-Than-Venice.mp3?rlkey=qgbxnx0jp5uf9vo3nfw2y17w9&st=m9xnf8x4&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/k2pz1q252vrdafehxd7hs/Photo-10-08-2025-22-23-47.jpg?rlkey=5qwjufmeqkrqjn98t39bje44l&st=gcy7s3su&dl=0')},
  {title:'Quack, Swim Buzz and Fly',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/jw6xnkf7psjn76k8era8s/Track-14-Quack-Swim-Buzz-and-Fly.mp3?rlkey=396fu5ghrsls87gkzs8f88mzr&st=fubp9e78&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/bgrl003tdpzv7ey9qiaq1/Photo-10-08-2025-22-24-05.jpg?rlkey=3vynlpmlbqncg42qrhpvf0rbl&st=rlpxu1tn&dl=0')},
  {title:'Love in the Locks',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/4hxkkjzm0b6pxgrf4mikp/Track-15-Love-in-the-Locks.mp3?rlkey=bkt4u3m84s3uwnsubwcbe7v1b&st=peta67o8&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/3ga3qbdrho0w5ljwfg2fs/Photo-10-08-2025-22-13-28.jpg?rlkey=jehce1x3co3ofxzmgls0khdst&st=s0cpoyyt&dl=0')},
  {title:'Super Slow Way',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/ma4aheyy1j9x0sjzec6jl/Track-16-Super-Slow-Way.mp3?rlkey=f8bwar30gcpwwpirryd5rsmfv&st=faxfc57b&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/z2q7nu2z0l8a2gl6u1mde/Photo-10-08-2025-22-24-15.jpg?rlkey=ypdh9ghkvgyg3wdz8ugmriq77&st=xlzqdg3y&dl=0')},
  {title:'Scarecastle',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/20jur7ooulgeezg9dk897/Track-17-Scarecastle.mp3?rlkey=96ipd8lpegpvxu4520js6995e&st=kifv781q&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/vbii37l6d57e3d0dpokip/Photo-10-08-2025-22-24-29.jpg?rlkey=nxfz4pupcrqw9wbsbuhn55uye&st=sejcil8s&dl=0')},
  /* --- Fixed broken URL (was httpss://) --- */
  {title:'Seasons of the Canal',artist:'Canal & River Trust',audio:directDropbox('httpsg://www.dropbox.com/scl/fi/z9hbewvhnop10umw8zeb6/Track-18-Seasons-of-the-Canal.mp3?rlkey=luirfqeldxsuqynhfehp802d8&st=chlc7xwd&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/01j60ezz17ntmiu52nrhn/Photo-10-08-2025-22-24-43.jpg?rlkey=b8cs9r0peywc25tt7hi0r3t6d&st=tdiihl75&dl=0')},
  {title:'Rolling Down The Cut',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/f1ebf2ao1wc655o8vpnmm/Track-19-Rolling-Down-The-Cut.mp3?rlkey=b0jjy91pdzqxby6d1sxuhd0xf&st=z136h7di&dl=0'),cover:directDropbox('httpss://www.dropbox.com/scl/fi/5axj4xl4zmsnohjlgmmc1/Photo-10-08-2025-22-30-41.jpg?rlkey=neig5apzjprqnrmuwa0cedooo&st=cmyhra68&dl=0')},
  {title:'All going on at the Crick Boat Show',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/kt8h561z77zfovtwyx4vb/Track-20-all-going-on-at-the-crick-boat-show.mp3?rlkey=rjazuuqe0qt2op07dsdz6ul7n&st=hsrsjzoa&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/rn3f6vvucjxye7qic5948/Photo-10-08-2025-22-30-54.jpg?rlkey=khitvavum2447yrxmg4bhtlca&st=o06p873v&dl=0')},
  /* --- Fixed broken URL (was httpss://) --- */
  {title:'I am the Worlds Biggest Gongoozler',artist:'Canal & River Trust',audio:directDropbox('https://www.dropbox.com/scl/fi/f8srtfpyofcxojueh0m8c/Track-21-I-am-the-Worlds-Biggest-Gongoozle.mp3?rlkey=kce1axvqg0jjnxitdec3txn6e&st=y890rpgu&dl=0'),cover:directDropbox('https://www.dropbox.com/scl/fi/adba6owfrknwdq9qnw3zk/Photo-10-08-2025-22-31-06.jpg?rlkey=0q2kvd68kvu753jos6d5vjhoc&st=qnfxipa5&dl=0')},
];

/******** State ********/
let queue=[]; // holds track indices
let current=null; // current track object
const audio=new Audio(); audio.preload='auto'; audio.crossOrigin='anonymous';
let isPlaying=false, pendingAutoplay=false;

/******** Elements ********/
const lib=document.getElementById('library');
const q=document.getElementById('queue');
const coverContainer=document.getElementById('coverContainer');
const ticker=document.querySelector('#ticker span');
const gate=document.getElementById('gate');
const startAudioBtn=document.getElementById('startAudio');
const skipBtn=document.getElementById('skipBtn');
const playPauseBtn=document.getElementById('playPauseBtn');

/******** UI helpers ********/
function showDefaultCover(){
    coverContainer.innerHTML='<div class="default-cover">Add new song to playlist</div>';
}
function showCover(src){
    const img = new Image();
    img.className = 'cover';
    img.alt = 'Album cover';
    img.src = src;
    coverContainer.innerHTML = '';
    coverContainer.appendChild(img);
}
function setNowPlaying(track){
  if(track){ 
    showCover(track.cover); 
    const text=`${track.title} — ${track.artist}`; 
    ticker.textContent=text; 
  }
  else{ 
    ticker.textContent='—'; 
    showDefaultCover(); 
  }
}
function showGate(){ gate.style.display='grid'; }
function hideGate(){ gate.style.display='none'; }

/******** Renderers ********/
function renderLibrary(){
  lib.innerHTML='';
  TRACKS.forEach((t,i)=>{
    const r=document.createElement('div'); r.className='row';
    r.innerHTML=`<img src="${t.cover}" style=\"width:44px;height:44px;border-radius:6px;object-fit:cover\" alt=\"\">`+
                `<div><div>${t.title}</div><div style=\"opacity:.8\">${t.artist}</div></div>`;
    r.onclick=()=>addToQueue(i);
    lib.appendChild(r);
  });
}
function renderQueue(){
  q.innerHTML='';
  if(queue.length===0){ q.innerHTML='<div class="row" style="opacity:.7">No tracks queued</div>'; }
  queue.forEach((idx,i)=>{
    const t=TRACKS[idx];
    const r=document.createElement('div'); r.className='row';
    r.innerHTML=`<img src="${t.cover}" style=\"width:44px;height:44px;border-radius:6px;object-fit:cover\" alt=\"\">`+
                `<div><div>${t.title}</div><div style=\"opacity:.8\">${t.artist}</div></div>`+
                `<button class="trash" title="Remove" aria-label="Remove">🗑</button>`;
    r.querySelector('.trash').onclick=(ev)=>{ ev.stopPropagation(); removeFromQueue(i); };
    r.onclick=()=>{ if(i===0){ audio.currentTime=1; } };
    q.appendChild(r);
  });
  skipBtn.disabled = queue.length===0;
  playPauseBtn.disabled = !current && queue.length===0;
}

/******** Queue ops ********/
function addToQueue(trackIndex){ queue.push(trackIndex); renderQueue(); if(!current){ playNext(); } }
function removeFromQueue(pos){ queue.splice(pos,1); renderQueue(); }

/******** Audio Controls ********/
function togglePlayPause() {
    if (!current) return; // Don't do anything if no track is loaded
    if (audio.paused) {
        audio.play();
    } else {
        audio.pause();
    }
}

function safePlay(){
  const tryPlay=()=>audio.play().then(()=>{isPlaying=true;pendingAutoplay=false;hideGate();}).catch(err=>{console.warn('Playback blocked/failed:',err&&err.name,err);pendingAutoplay=true;showGate();});
  if(audio.readyState>=2){ tryPlay(); } else { const onCanPlay=()=>{audio.removeEventListener('canplay',onCanPlay);tryPlay();}; audio.addEventListener('canplay',onCanPlay,{once:true}); audio.load(); }
}

function playNext(){
  if(queue.length===0){ 
      current=null; 
      isPlaying=false; 
      setNowPlaying(null); 
      renderQueue(); 
      playPauseBtn.innerHTML = '▶';
      return; 
  }
  const nextIdx=queue.shift(); 
  renderQueue(); 
  current=TRACKS[nextIdx]; 
  setNowPlaying(current); 
  audio.src=current.audio; 
  safePlay();
}

/******** Events ********/
skipBtn.addEventListener('click',()=>{ 
    if (current) audio.pause(); 
    playNext(); 
});
playPauseBtn.addEventListener('click', togglePlayPause);

audio.addEventListener('ended',playNext);
audio.addEventListener('play',()=>{
    isPlaying=true;
    pendingAutoplay=false;
    playPauseBtn.innerHTML = 'II';
    playPauseBtn.disabled = false;
});
audio.addEventListener('pause',()=>{
    isPlaying=false;
    playPauseBtn.innerHTML = '▶';
});
audio.addEventListener('error',(e)=>{ console.warn('Audio error', audio.error && audio.error.code, e); });

startAudioBtn.addEventListener('click',()=>{
    pendingAutoplay=false;
    if(current) {
        safePlay();
    }
});

window.addEventListener('click',()=>{
    if(pendingAutoplay && current){
        safePlay();
    }
},{capture:true});

/******** Init ********/
setNowPlaying(null); 
renderLibrary(); 
renderQueue();
</script>
</body>
</html>

